<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="givook.mapper">

   <select id="selectByAll" resultType="com.twoyears.model.board.BoardBookDTO">
      select * from notice

   </select>

   <select id="selectCount" resultType="int" parameterType="map">
      select count(*) from notice
      n, books b where n.noticeno=b.noticeno and bookgenre like '%'||'${genre}'||'%'
   </select>

   <select id="selectByRownum" resultType="com.twoyears.model.board.BoardBookDTO"
      parameterType="map">
      select * from
      (select rownum as rn, t1.* from
      (select n.noticeno,
      n.userid, n.noticetitle, to_char(n.noticedate,'yyyy/mm/dd hh:mi:ss') "noticedate", 
      n.noticestatus, n.noticecontent, n.noticecount,
      n.noticemethod, n.noticelocation,
      b.bookSubject, b.bookPic, b.bookPrice,
      b.bookGenre, b.bookNum, b.bookQTY,
      u.userpwd, u.username,u.usernick,u.userphone, u.useremail, u.userpoint
      from notice
      n, books b, users u 
      where n.userid=u.userid and n.noticeno=b.noticeno and bookgenre like '%'||'${genre}'||'%'
      order by noticedate desc) t1
      )
      where rn between ${low} and ${high}

      <!-- select * from (select ROWNUM rnum, a.* From (select * from notice) 
         a where ROWNUM &lt;=#{hi}) where rnum >= #{low} -->
   </select>

   <select id="selectByTitle" resultType="com.twoyears.model.board.BoardBookDTO"
      parameterType="map">
      select * from
      (select rownum as rn, t1.* from
      (select
      n.noticeno, n.userid, n.noticetitle, to_char(n.noticedate,'yyyy/mm/dd hh:mi:ss') "noticedate",
      n.noticestatus, n.noticecontent, n.noticecount, n.noticemethod,n.noticelocation,
      b.bookSubject, b.bookPic, b.bookPrice, b.bookGenre, b.bookNum, b.bookQTY,
      u.userpwd, u.username,u.usernick,u.userphone, u.useremail, u.userpoint
      from notice   n, books b, users u 
      where n.userid=u.userid and n.noticeno=b.noticeno and bookgenre like '%'||'${genre}'||'%'
      and   noticetitle like '%'||'${title}'||'%' order by noticedate desc) t1
      )
      where rn
      between ${low} and
      ${high}
   </select>
   <select id="selectByContent" resultType="com.twoyears.model.board.BoardBookDTO"
      parameterType="map">
      select * from
      (select rownum as rn, t1.* from
      (select
      n.noticeno, n.userid, n.noticetitle, to_char(n.noticedate,'yyyy/mm/dd hh:mi:ss') "noticedate",
      n.noticestatus, n.noticecontent, n.noticecount, n.noticemethod,n.noticelocation,
      b.bookSubject, b.bookPic, b.bookPrice, b.bookGenre, b.bookNum, b.bookQTY,
      u.userpwd, u.username,u.usernick,u.userphone, u.useremail, u.userpoint
      from notice   n, books b, users u 
      where n.userid=u.userid and n.noticeno=b.noticeno and 
      bookgenre like '%'||'${genre}'||'%' and
      noticecontent like '%'||'${content}'||'%' order by noticedate desc) t1
      )
      where rn between ${low} and ${high}
   </select>
   <select id="selectByUser" resultType="com.twoyears.model.board.BoardBookDTO"
      parameterType="map">
      select * from
      (select rownum as rn, t1.* from
      (select
      n.noticeno, n.userid, n.noticetitle, to_char(n.noticedate,'yyyy/mm/dd hh:mi:ss') "noticedate",
      n.noticestatus, n.noticecontent, n.noticecount, n.noticemethod,n.noticelocation,
      b.bookSubject, b.bookPic, b.bookPrice, b.bookGenre, b.bookNum, b.bookQTY,
      u.userpwd, u.username,u.usernick,u.userphone, u.useremail, u.userpoint
      from notice   n, books b, users u 
      where n.userid=u.userid and n.noticeno=b.noticeno and
      bookgenre like '%'||'${genre}'||'%' and
      userNick like '%'||'${user}'||'%' order by noticedate desc) t1
      )
      where rn between ${low} and ${high}
   </select>

   <select id="selectByTitleCount" resultType="int" parameterType="map">
      select count(*) 
      from notice n, books b, users u 
      where n.userid=u.userid and 
      n.noticeno=b.noticeno and 
      bookgenre like '%'||'${genre}'||'%' and
      noticetitle LIKE '%'||'${title}'||'%'
   </select>

   <select id="selectByContentCount" resultType="int"
      parameterType="map">
      select count(*) from notice n, books b, users u 
      where n.userid=u.userid and
      n.noticeno=b.noticeno and 
      bookgenre like '%'||'${genre}'||'%' and
      noticecontent LIKE '%'||'${content}'||'%'
   </select>
   <select id="selectByUserCount" resultType="int" parameterType="map">
      select count(*) from notice n, books b, users u 
      where u.userid=n.userid and
      n.noticeno=b.noticeno and
      bookgenre like '%'||'${genre}'||'%' and
      userNick LIKE '%'||#{user}||'%'
   </select>

</mapper>