<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="givook.mapper.request">

	<select id="selectByAll" resultType="com.twoyears.model.request.RequestDTO">
		select * from request_notice

	</select>

	<select id="selectCount" resultType="int">
		select count(*) from
		request_notice
	</select>

	<select id="selectByRownum" resultType="com.twoyears.model.request.RequestDTO"
		parameterType="map">
		select * from
		(select rownum as rn, t1.* from
		(select n.*,
		u.userpwd,u.username,u.usernick, u.userphone,u.useremail,u.userpoint
		from request_notice n, users u
		where u.userid=n.userid order by rqdate)
		t1
		)
		where rn between ${low} and ${high}

		<!-- select * from (select ROWNUM rnum, a.* From (select * from notice) 
			a where ROWNUM &lt;=#{hi}) where rnum >= #{low} -->
	</select>

	<select id="selectByTitle" resultType="com.twoyears.model.request.RequestDTO"
		parameterType="map">
		select *
		from (select rownum as rn, t1.* from
		(select n.*,
		u.userpwd,u.username,u.usernick, u.userphone,u.useremail,u.userpoint
		from request_notice n, users u
		where u.userid=n.userid and rqtitle like '%'||#{title}||'%' order by
		rqdate) t1
		)
		where rn between ${low} and ${high}
	</select>
	
	<select id="selectByContent" resultType="com.twoyears.model.request.RequestDTO"
		parameterType="map">
		select * from
		(select rownum as rn, t1.* from
		(select n.*,
		u.userpwd,u.username,u.usernick,u.userphone,u.useremail,u.userpoint
		from request_notice n, users u
		where u.userid=n.userid and rqcontent like '%'||#{content}||'%' order by
		rqdate) t1
		)
		where rn between ${low} and ${high}
	</select>
	<select id="selectByUser" resultType="com.twoyears.model.request.RequestDTO"
		parameterType="map">
		select * from
		(select rownum as rn, t1.* from
		(select
		n.*,u.userpwd,u.username,u.usernick,u.userphone,u.useremail,u.userpoint
		from request_notice n, users u
		where u.userid=n.userid and userNick like '%'||#{user}||'%' order by
		rqdate) t1
		)
		where rn between ${low} and ${high}
	</select>

	<select id="selectByTitleCount" resultType="int" parameterType="map">
		select count(*) from request_notice n where rqtitle LIKE
		'%'||#{title}||'%'
	</select>

	<select id="selectByContentCount" resultType="int"
		parameterType="map">
		select count(*) from request_notice n where rqcontent
		LIKE '%'||#{content}||'%'
	</select>
	<select id="selectByUserCount" resultType="int" parameterType="map">
		select count(*)
		from request_notice n, users u
		where n.userid=u.userid and userNick LIKE '%'||#{user}||'%'
	</select>

	<select id="userSelectByMyWirte" resultType="noticejoinbook"
		parameterType="String">
		select n.noticeTitle, n.noticeNo, b.bookGenre,
		n.noticeMethod, n.noticeDate, n.noticeCount, n.noticeLocation from notice n, books b
		where n.userId=#{userId} and n.noticeNo=b.noticeNo
	</select>

	<select id="userSelectByMyRequestWirte" resultType="noticejoinbook"
		parameterType="String">
		select * from request_notice where userId=#{userId}
	</select>

</mapper>