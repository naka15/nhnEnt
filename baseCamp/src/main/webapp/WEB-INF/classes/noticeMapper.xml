<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="givook.notice">

  <select id="selectBynextVal" resultType="int">
 select sq_notice.nextval from dual
  </select> 
  
  <insert id="insertNotice" parameterType="noticedto" >
  insert into notice(noticeNo, userId, noticeTitle, noticeDate, noticeStatus,
noticeContent, noticeCount, noticeMethod, noticeLocation) values
(
#{noticeNo:INTEGER},
#{userId:VARCHAR},
#{noticeTitle:VARCHAR}, 
sysdate,
'1',
#{noticeContent:VARCHAR},
0,
#{noticeMethod:VARCHAR},
#{noticeLocation:VARCHAR}
)
  </insert>
  
   <insert id="insertBook" parameterType="bookdto">
  insert into books(noticeNo, bookSubject, bookPrice, bookPic, bookGenre ,bookNum, bookQty) values (
#{noticeNo:INTEGER}, 
#{bookSubject:VARCHAR},
#{bookPrice:VARCHAR},
#{bookPic:VARCHAR},
#{bookGenre:VARCHAR},
#{bookNum:VARCHAR},
#{bookQty:VARCHAR}
)
  
  </insert>
  
  <update id="updateCount" parameterType="Map"  >
  update notice set noticeCount=#{noticeCount:INTEGER} where noticeNo=#{noticeNo:INTEGER}
  </update>
  
  <select id="selectBynoticeAll" resultType="noticedto" parameterType="int">
 
  select * from notice where noticeNo=#{noticeNo}
  </select>
  
  
  <select id="selectByBookAll" resultType="bookdto" parameterType="int">
  select * from books where noticeNo=#{noticeNo}
  </select>
  
  <insert id="createReply" parameterType="replydto">
  insert into reply (replyNo, noticeNo, userId, replyContent, replyDate)
  values
  (
  sq_reply.nextval,
  #{noticeNo:INTEGER},
  #{userId:VARCHAR},
  #{replyContent:VARCHAR},
  sysdate
  )
  </insert>
  
  <delete id="deleteReply" parameterType="map">
  delete from reply where noticeNo=#{noticeNo} and replyNo=#{replyNo}
   and userId=#{userId}
  </delete>
  
  <select id="selectReplyList" resultType="replydto" parameterType="int">
  select replyNo, noticeNo, userId, replyContent, to_char(replyDate, 'yyyy/mm/dd hh:mi:ss') "replyDate" from reply where noticeNo=#{noticeNo}
  </select>
  
  
  
  </mapper>