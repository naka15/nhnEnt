<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="givook.mapper">

	<select id="selectByAll" resultType="com.twoyears.model.board.BoardBookDTO">
		select * from notice

	</select>

	<select id="selectCount" resultType="int">
		select count(*) from notice n, books b where n.noticeno=b.noticeno
	</select>

	<select id="selectByRownum" resultType="com.twoyears.model.board.BoardBookDTO"
		parameterType="map">
		select * from
		(select rownum as rn, t1.* from
		(select n.*,
		b.bookSubject, b.bookPic, b.bookPrice, b.bookGenre, b.bookNum,
		b.bookQTY from notice n, books b where n.noticeno=b.noticeno order by noticedate desc) t1
		)
		where rn between ${low} and ${high}

		<!-- select * from (select ROWNUM rnum, a.* From (select * from notice) 
			a where ROWNUM &lt;=#{hi}) where rnum >= #{low} -->
	</select>

	<select id="selectByTitle" resultType="com.twoyears.model.board.BoardBookDTO"
		parameterType="map">
		select * from
		(select rownum as rn, t1.* from
		(select n.*,
		b.bookSubject, b.bookPic, b.bookPrice, b.bookGenre, b.bookNum,
		b.bookQTY from notice n, books b where n.noticeno=b.noticeno and
		noticetitle like '%'||#{title}||'%' order by noticedate desc) t1
		)
		where rn
		between ${low} and ${high}
	</select>
	<select id="selectByContent" resultType="com.twoyears.model.board.BoardBookDTO"
		parameterType="map">
		select * from
		(select rownum as rn, t1.* from
		(select n.*,
		b.bookSubject, b.bookPic, b.bookPrice, b.bookGenre, b.bookNum,
		b.bookQTY from notice n, books b where n.noticeno=b.noticeno and
		noticecontent like '%'||#{content}||'%' order by noticedate desc) t1
		)
		where rn
		between ${low} and ${high}
	</select>
	<select id="selectByUser" resultType="com.twoyears.model.board.BoardBookDTO"
		parameterType="map">
		select * from
		(select rownum as rn, t1.* from
		(select
		n.*,b.bookSubject, b.bookPic, b.bookPrice, b.bookGenre, b.bookNum,
		b.bookQTY from notice n, books b where n.noticeno=b.noticeno and
		noticeuser like '%'||#{user}||'%' order by noticedate desc) t1
		)
		where rn
		between ${low} and ${high}
	</select>

	<select id="selectByTitleCount" resultType="int" parameterType="map">
		select count(*) from notice n, books b where n.noticeno=b.noticeno and noticetitle LIKE '%'||#{title}||'%'
	</select>

	<select id="selectByContentCount" resultType="int"
		parameterType="map">
		select count(*) from notice n, books b where n.noticeno=b.noticeno and noticecontent LIKE
		'%'||#{content}||'%'
	</select>
	<select id="selectByUserCount" resultType="int" parameterType="map">
		select count(*) from notice n, books b where n.noticeno=b.noticeno and userid LIKE '%'||#{user}||'%'
	</select>

</mapper>